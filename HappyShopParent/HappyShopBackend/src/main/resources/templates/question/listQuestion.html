<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head th:replace="fragments :: page_head('List Question','none')">
</head>
<body>
	<div class="container-fluid">  
		<!-- navigation -->
		<div th:replace="navigation :: nav"></div>  

		<div class="text-center text-info">
			<p class="fs-1">Manage Questions</p>
		</div>
		<div class="alert alert-primary" th:if="${message != null}"   
			role="alert" th:text="${message}">
		</div>

		<!-- search-->
		<th:block th:if="${elementsCurrentPerPage > 0}">
			<div th:replace="fragments :: search ('Question')"></div>
		</th:block>

		<div class="full-details" th:if="${totalElement > 0}">
			<table
				class="table table-active table-striped table-inverse
				table-hover table-responsive mt-4 ">
				<thead class="thead-inverse ">
					<tr>
						<th th:replace="fragments :: column_link('id', 'ID')"></th>
						<th
							th:replace="fragments :: column_link('product', 'Product')"></th>
						<th th:replace="fragments :: column_link('question_content', 'Question')"></th>
						<th th:replace="fragments :: column_link('customer', 'Customer')"></th>
						<th th:replace="fragments :: column_link('askTime', 'Ask Time')"></th>
						<th th:replace="fragments :: column_link('answerStatus', 'Answered')"></th>						
						<th></th>
					</tr>
				</thead>
				<tbody>
					<tr th:each=" question: ${questions}">
						<td scope="row" th:text="${question.id}"></td>
						<td><a th:href="@{'/product/detail/' + ${question.product.id}}"
							class="link-detail-product" th:title="${question.product.name}"
							style="text-decoration: none">[[${question.product.shortName}]]</a></td>
						<td>
							[[${question.question_content}]]
						</td>
						<td>
							<a th:href="@{'/customer/detail/' + ${question.customer.id}}"
									title="Detail customer" class="me-3 link-detail-customer">
									[[${question.customer.getFullName}]] 
							</a>
						</td>
						<td>	
							<div th:replace="fragments :: format_time(${question.askTime})"></div>						
						</td>
						<td>
							<i th:if="${question.answerStatus}"
							class="fa-solid fa-circle-check"></i> 
							<i
								th:unless="${question.answerStatus}"
								class="fa-solid fa-circle fa-gray"></i>
						</td>
						<td>
							<div class="float-start">
								<a th:href="@{'/question/detail/' + ${question.id}}"
									title="Detail question" class="me-3 link-detail-question"> <i
									class="fa-sharp fa-solid fa-circle-info"></i>
								</a>
								
								<a th:href="@{'/question/delete/' + ${question.id}}"
									class="deleteQuestion me-3" th:questionId = "${question.id}"
									title="Delete"> <i class="fa-solid fa-trash fa-red"></i>
								</a>
																								  
							</div>
							<div
								th:replace="fragments :: update(${question.id})">
							</div>
							
						</td>
					</tr>
				</tbody>
			</table>
		</div>

		<div class="less-details">
			<div th:each=" question: ${questions}" class="row">
				<div class="">
					<p>Id: [[${question.id}]]</p>
					<a th:href="@{'/product/detail/' + ${question.product.id}}"
							class="link-detail-product" th:title="${question.product.name}"
							style="text-decoration: none">[[${question.product.shortName}]]
					</a>											
				</div>
				<div class="d-flex justify-content-start">
					<a th:href="@{'/question/detail/' + ${question.id}}"
						title="Detail question" class="ms-3 me-3 link-detail-question"> <i
						class="fa-sharp fa-solid fa-circle-info"></i>
					</a>
					
					<a th:href="@{'/question/delete/' + ${question.id}}"
						class="deleteQuestion me-3" th:questionId = "${question.id}"
						title="Delete"> <i class="fa-solid fa-trash fa-red"></i>
					</a>
				
					<div th:replace="fragments :: update(${question.id})">
					</div>
				</div>
				<hr />
			</div>
		</div>
	</div>

	<!-- modal -->
	<div th:replace="modal_fragments :: confirmationModal"></div>
	<div th:replace="modal_fragments :: detailModal('detailModalCustomer')"></div>
	<div th:replace="modal_fragments :: detailModal('detailModalProduct')"></div>
	<div th:replace="modal_fragments :: detailModal('detailModalQuestion')"></div>


	<div th:replace="fragments :: countElement('Question')"></div>
	<!-- pagination -->
	<div th:replace="fragments :: pagination()"></div>
	<!-- footer -->
	<div th:replace="fragments :: footer"></div>

	<script>
		$(document).ready(function(){
			
			handleShowDetailModal('link-detail-customer', 'detailModalCustomer');
			handleShowDetailModal('link-detail-product', 'detailModalProduct');
			handleShowDetailModal('link-detail-question' , 'detailModalQuestion');
				
			$(".deleteQuestion").click( function(e) {
						e.preventDefault();
						questionId = $(this).attr("questionId");
						showConfirmationModal("Are you sure to delete this question id: " + questionId);
						$("#deleteOption").attr("href",$(this).attr("href"));
			});
		});
		
		function handleShowDetailModal(link, detailModalName){
			$("." +link).on("click",function(e) {
				e.preventDefault();
				linkDetailUrl = $(this).attr("href");
				$("#" +detailModalName).modal("show").find(".modal-content").load(linkDetailUrl);
			});
		}
				
		
	</script>
	<script th:src="@{/js/common_form.js}"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js"
		integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk"
		crossorigin="anonymous"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.min.js"
		integrity="sha384-kjU+l4N0Yf4ZOJErLsIcvOU2qSb74wXpOhqTvwVx3OElZRweTnQ6d31fXEoRD1Jy"
		crossorigin="anonymous"></script>
</body>
</html>